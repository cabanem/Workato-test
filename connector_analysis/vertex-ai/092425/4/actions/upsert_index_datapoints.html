<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>upsert_index_datapoints â€” Call Graph</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;margin:0;background:#fafafa}
    header{padding:16px 20px;border-bottom:1px solid #e5e7eb;background:#fff;position:sticky;top:0}
    main{padding:16px}
    pre.mermaid{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;overflow:auto}
    .legend{display:flex;gap:8px;align-items:center;margin:12px 0 20px}
    .chip{border-radius:10px;padding:2px 8px;border:1px solid #e5e7eb}
    .chip.action{background:#E3F2FD;border-color:#1E88E5}
    .chip.method{background:#E8F5E9;border-color:#2E7D32}
    .chip.http{background:#FFF3E0;border-color:#EF6C00}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true, securityLevel: 'loose', theme: 'default' });</script>
</head>
<body>
  <header>
    <h1 style="margin:0;font-size:18px">Action: upsert_index_datapoints</h1>
  </header>
  <main>
    <div class="legend">
      <span class="chip action">Action entrypoint</span>
      <span class="chip method">Method</span>
      <span class="chip http">Direct HTTP</span>
    </div>
    <pre class="mermaid">flowchart TD
  execute_upsert_index_datapoints([execute:upsert_index_datapoints])
  batch_upsert_datapoints[batch_upsert_datapoints]
  validate_index_access[validate_index_access]
  process_datapoint_batch[process_datapoint_batch]
  build_upsert_payload[build_upsert_payload]
  format_datapoint[format_datapoint]
  validate_datapoint[validate_datapoint]
  format_restricts[format_restricts]
  with_resilience[with_resilience]
  rate_limit_defaults[rate_limit_defaults]
  enforce_vertex_rate_limits[enforce_vertex_rate_limits]
  gen_correlation_id[gen_correlation_id]
  circuit_breaker_retry[circuit_breaker_retry]
  get_circuit_state[get_circuit_state]
  HTTP_GET{{HTTP:GET}}
  check_circuit_status[check_circuit_status]
  log_debug[log_debug]
  handle_circuit_success[handle_circuit_success]
  update_circuit_state[update_circuit_state]
  should_retry_error[should_retry_error]
  extract_http_status[extract_http_status]
  calculate_backoff_delay[calculate_backoff_delay]
  handle_circuit_failure[handle_circuit_failure]
  should_open_circuit[should_open_circuit]
  HTTP_DELETE{{HTTP:DELETE}}
  api_request[api_request]
  HTTP_POST{{HTTP:POST}}
  HTTP_PUT{{HTTP:PUT}}
  handle_upsert_error[handle_upsert_error]
  handle_vertex_error[handle_vertex_error]
  execute_upsert_index_datapoints --> batch_upsert_datapoints
  with_resilience --> rate_limit_defaults
  with_resilience --> enforce_vertex_rate_limits
  with_resilience --> gen_correlation_id
  with_resilience --> circuit_breaker_retry
  with_resilience --> HTTP_DELETE
  api_request --> HTTP_GET
  api_request --> HTTP_POST
  api_request --> HTTP_PUT
  api_request --> HTTP_DELETE
  get_circuit_state --> HTTP_GET
  check_circuit_status --> log_debug
  should_retry_error --> extract_http_status
  handle_circuit_success --> update_circuit_state
  handle_circuit_success --> log_debug
  handle_circuit_failure --> should_open_circuit
  handle_circuit_failure --> log_debug
  circuit_breaker_retry --> rate_limit_defaults
  circuit_breaker_retry --> get_circuit_state
  circuit_breaker_retry --> check_circuit_status
  circuit_breaker_retry --> handle_circuit_success
  circuit_breaker_retry --> should_retry_error
  circuit_breaker_retry --> calculate_backoff_delay
  circuit_breaker_retry --> log_debug
  circuit_breaker_retry --> handle_circuit_failure
  format_datapoint --> validate_datapoint
  format_datapoint --> format_restricts
  build_upsert_payload --> format_datapoint
  handle_upsert_error --> handle_vertex_error
  process_datapoint_batch --> build_upsert_payload
  process_datapoint_batch --> with_resilience
  process_datapoint_batch --> api_request
  process_datapoint_batch --> handle_upsert_error
  batch_upsert_datapoints --> validate_index_access
  batch_upsert_datapoints --> process_datapoint_batch
  classDef action fill:#E3F2FD,stroke:#1E88E5,stroke-width:1px;
  classDef method fill:#E8F5E9,stroke:#2E7D32,stroke-width:1px;
  classDef http   fill:#FFF3E0,stroke:#EF6C00,stroke-width:1px;
  classDef hot stroke:#6A1B9A,stroke-width:3px;
  classDef cycle stroke:#C62828,stroke-width:3px;
  classDef unused fill:#ECECEC,color:#6B7280,stroke:#9CA3AF;
  classDef undef stroke-dasharray:4 2,stroke:#EF4444;
  class execute_upsert_index_datapoints action;
  class batch_upsert_datapoints method;
  class validate_index_access method;
  class process_datapoint_batch method;
  class build_upsert_payload method;
  class format_datapoint method;
  class validate_datapoint method;
  class format_restricts method;
  class with_resilience method;
  class rate_limit_defaults method;
  class enforce_vertex_rate_limits method;
  class gen_correlation_id method;
  class circuit_breaker_retry method;
  class get_circuit_state method;
  class check_circuit_status method;
  class log_debug method;
  class handle_circuit_success method;
  class update_circuit_state method;
  class should_retry_error method;
  class extract_http_status method;
  class calculate_backoff_delay method;
  class handle_circuit_failure method;
  class should_open_circuit method;
  class api_request method;
  class handle_upsert_error method;
  class handle_vertex_error method;
  class HTTP_GET http;
  class HTTP_DELETE http;
  class HTTP_POST http;
  class HTTP_PUT http;
  class with_resilience hot;
  class api_request hot;
  class circuit_breaker_retry hot;
  class log_debug hot;</pre>
  </main>
</body>
</html>
